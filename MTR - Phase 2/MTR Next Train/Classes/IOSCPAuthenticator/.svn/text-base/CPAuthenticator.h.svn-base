//
//  CPAuthenticator.h
//  CPAuthenticator
//
//  Created by Kenth Fagerlund on 6/3/12.
//  Copyright (c) 2012 Cherrypicks. All rights reserved.
//

#import <Foundation/Foundation.h>
#import <UIKit/UIKit.h>

// CPAuthenticator is used to sign and authenticate URL encoded messages.
// 
// When signing a URL message, it will append an "&x-hash=[hash]"-tag at the end of the URL which
// later can be used to authenticate the message with this same class.
//
// Usage:
// ======
//
// Sign URL:
// -----
// NSString *signedURL = [CPAuthenticator signURL:@"the full url to be signed"];
//     - This will output something like:
//                 "schema://yoururl?par="value"&x-hash=168545414f76656b09107ff925cd905f920d2c980857c09cffc4d3df85678b17"
//
//
// Authenticate URL:
// -----
// BOOL success = [CPAuthenticator authenticateURL:@"the signed URL"];
//     - This will output YES/TRUE if the message is authentic
//                 
//
//
// NOTE
// ----
// This authentication will only work within the same device so it is not garanteed to work
// if the URL is sent to a different device. 
@interface CPAuthenticator : NSObject

// Will authenticate a URL that has a "&x-hash=[hash]"-tag appended to it. It will only work if the
// tag has been generated by CPAuthenticator class.
+ (BOOL) authenticateURL: (NSString*) url;

// Here the URL will signed by a "&x-hash=[hash]"-tag beeing appended to it. 
+ (NSString*) signURL: (NSString*) url;

@end
